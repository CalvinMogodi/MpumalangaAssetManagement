<p-toast [style]="{marginTop: '90px'}" position="top-right"></p-toast>
<p-tabView [(activeIndex)]="activeIndex">
    <p-tabPanel header="Land" style="background-color: var(--surface-b);
    color: var(--text-color);">
        <form [formGroup]="landForm" *ngIf="!loading" (ngSubmit)="onLandFormSubmit()">
            <div class="p-fluid p-grid p-formgrid"
                style="overflow-y: auto; overflow-x: hidden; height: 500px;width: 100%">
                <div class="ui-g-12 ui-md-12" *ngIf="mode != 'View'">
                    <p-fileUpload [showUploadButton]="false" [showCancelButton]="false"
                        (onRemove)="onLandRemoveFile($event)" multiple="multiple"
                        (onSelect)="onLandSelectFile($event.files)"></p-fileUpload>
                    <div>
                        <ul *ngFor="let file of landFiles; let i = index" style="list-style-type:none;">
                            <li>
                                <p><a target="_blank" href="{{ file.url }}">{{ file.name }}</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <p-fieldset legend="General" [toggleable]="true" styleClass="mt-2">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="fileReference">File Reference Number</label>
                                <input [(ngModel)]="facility.fileReference" [ngModelOptions]="{standalone: true}"
                                    [disabled]="isViewOnly" autocomplete="off" type="text" pInputText
                                    class="ui-inputtext ui-widget">                           
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="clientCode">Property Code</label>
                                <input formControlName="clientCode" autocomplete="off" [disabled]="isViewOnly"
                                    type="text" pInputText class="ui-inputtext ui-widget">                               
                                <div *ngIf="submitted && f.clientCode.errors" class="text-error"><br>
                                    <div *ngIf="l.propertyCode.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="facilityName">Facility Name</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="facilityName"
                                    autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget">                                
                                <div *ngIf="submitted && f.facilityName.errors" class="text-error"><br>
                                    <div *ngIf="l.facilityName.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="facilityType">Type</label>
                                <p-dropdown class="ui-inputtext ui-widget" inputId="facilityType" [style]="{'width':'570px'}"
                                    (onChange)="setFacilityType($event)" [disabled]="isViewOnly"
                                    [options]="facilityTypes" placeholder="Please select" formControlName="facilityType"
                                    optionLabel="name">
                                </p-dropdown>                                
                                <div *ngIf="submitted && f.facilityType.errors" class="text-error"><br>
                                    <div *ngIf="l.facilityType.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="survey">Survey</label>
                                <p-dropdown class="ui-inputtext ui-widget" inputId="survey" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                    [options]="surveys" placeholder="Please select" formControlName="survey"
                                    optionLabel="name">
                                </p-dropdown>                                
                                <div *ngIf="submitted && f.survey.errors" class="text-error"><br>
                                    <div *ngIf="l.survey.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="vestedType">Vested Type</label>
                                <p-dropdown class="ui-inputtext ui-widget" inputId="vestedType" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                    [options]="vestedTypes" placeholder="Please select" formControlName="vestedType"
                                    optionLabel="name">
                                </p-dropdown>                               
                                <div *ngIf="submitted && f.vestedType.errors" class="text-error"><br>
                                    <div *ngIf="l.vestedType.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="type">Asset Type</label>
                                <p-dropdown class="ui-inputtext ui-widget" inputId="type" [disabled]="isViewOnly"  [style]="{'width':'570px'}"
                                    [options]="types" placeholder="Please select" (onChange)="setType($event)"
                                    formControlName="type" optionLabel="name"></p-dropdown>                                
                                <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                    <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="deedsOffice">Deeds Office</label>
                                <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="deedsOffice"  [style]="{'width':'570px'}"
                                    [options]="deedsOffices" placeholder="Please select" formControlName="deedsOffice"
                                    (onChange)="setDeedsOffice($event)" optionLabel="name"></p-dropdown>                               
                                <div *ngIf="submitted && f.deedsOffices.errors" class="text-error"><br>
                                    <div *ngIf="l.deedsOffices.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="class">Asset Class</label>
                                <p-dropdown class="ui-inputtext ui-widget" inputId="class" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                    [options]="classes" placeholder="Please select" formControlName="class"
                                    (onChange)="setClass($event)" optionLabel="name">
                                </p-dropdown>
                                <div *ngIf="submitted && f.class.errors" class="text-error"><br>
                                    <div *ngIf="l.class.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1">
                                <label for="userDepartment">User Department</label>
                                <p-multiSelect class="ui-inputtext ui-widget" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                    placeholder="Please select" inputId="userDepartment" [options]="userDepartments"
                                    formControlName="userDepartment" optionLabel="name"></p-multiSelect>
                                <div *ngIf="submitted && l.userDepartment.errors" class="text-error">
                                    <br>
                                    <div *ngIf="l.userDepartment.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                    </div>
                </p-fieldset>

                <p-fieldset legend="Geographical Location" [toggleable]="true" styleClass="mt-2">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Province</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="province" [style]="{'width':'570px'}"
                                [(ngModel)]="province" [options]="provinces" formControlName="province"
                                (onChange)="setProvince($event)" optionLabel="name">
                            </p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">District Municipality</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                inputId="districtMunicipality" [options]="districtMunicipalities"
                                placeholder="Please select" formControlName="districtMunicipality"
                                (onChange)="setDistrictMunicipality($event)" optionLabel="name"></p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Magisterial District</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                inputId="magisterialDistrict" [options]="magisterialDistricts"
                                placeholder="Please select" formControlName="magisterialDistrict"
                                (onChange)="setMagisterialDistrict($event)" optionLabel="name"></p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Local Authority</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="localAuthority"
                                [options]="localAuthorities" placeholder="Please select" [style]="{'width':'570px'}"
                                formControlName="localAuthority" (onChange)="setLocalAuthorities($event)"
                                optionLabel="name"></p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Region</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="region" [style]="{'width':'570px'}"
                                [options]="regions" formControlName="region" placeholder="Please select"
                                (onChange)="setProvince($event)" optionLabel="name">
                            </p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Town</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="town" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                    <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Suburb</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="suburb" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Street Name </label>
                            <input [attr.disabled]="mode == 'View'" formControlName="streetName" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Street Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="streetNumber" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">GPS Coordinates Longitude</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="longitude"
                                ng-pattern="/^[-+]?[0-9]{1,7}(\.[0-9]+)?$/" autocomplete="off" type="text" pInputText
                                class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">GPS Coordinates Latitude</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="latitude" autocomplete="off"
                                ng-pattern="/^[-+]?[0-9]{1,7}(\.[0-9]+)?$/" type="text" pInputText
                                class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                </p-fieldset>

                <p-fieldset legend="Property Description" [toggleable]="true" styleClass="mt-2">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Registration Division</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                inputId="registrationDivision" [options]="registrationDivisions"
                                placeholder="Please select" [(ngModel)]="registrationDivision"
                                formControlName="registrationDivision" optionLabel="name"></p-dropdown>
                            <div *ngIf="submitted && f.registrationDivision.errors" class="text-error"><br>
                                <div *ngIf="l.registrationDivision.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Township Name</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="townshipName" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.townshipName.errors" class="text-error"><br>
                                <div *ngIf="l.townshipName.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Land Parcel</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="landParcel" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Land Portion</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="landPortion" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <input [attr.disabled]="mode == 'View'" formControlName="oldDescription" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <label for="float-input">Old Description</label>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Land Remainder</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="landRemainder" [style]="{'width':'570px'}"
                                [options]="landRemainders" formControlName="landRemainder"
                                (onChange)="setProvince($event)" optionLabel="name" placeholder="Please select">
                            </p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="float-input">Farm Name</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="farmName" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="SGDiagramNumber">SG Diagram Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="SGDiagramNumber" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="extent">Extent (Size of Land) (HA)</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="extent" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="LPICode">LPI Code </label>
                            <input [attr.disabled]="mode == 'View'" formControlName="LPICode" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="howAcquired">How Acquired</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="howAcquired"
                                [options]="howAcquireds" [(ngModel)]="howAcquired" formControlName="acquired" [style]="{'width':'570px'}"
                                (onChange)="setHowAcquired($event)" optionLabel="name" placeholder="Please select">
                            </p-dropdown>
                            <div *ngIf="submitted && f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left" *ngIf="howAcquired.name === 'Other'">
                            <label for="acquiredOther">How acquired: other</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="acquiredOther" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.howAcquired.errors" class="text-error"><br>
                                <div *ngIf="l.howAcquired.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                </p-fieldset>

                <p-fieldset legend="Land Use & Management Details" [toggleable]="true" styleClass="mt-2">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="titleDeedNumber">Title Deed Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="titleDeedNumber" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.titleDeedNumber.errors" class="text-error">
                                <br>
                                <div *ngIf="l.titleDeedNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="class">Registration Date</label>
                            <p-calendar class="ui-inputtext ui-widget" [disabled]="isViewOnly" [maxDate]="today"
                                formControlName="registrationDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted&& f.fileReferenceNumber.errors" class="text-error"><br>
                                <div *ngIf="l.fileReferenceNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="registeredOwner">Registered Owner</label>
                            <!--[attr.disabled]="mode == 'View'"-->
                            <input formControlName="registeredOwner" autocomplete="off" type="text" pInputText
                                class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.registeredOwner.errors" class="text-error">
                                <br>
                                <div *ngIf="l.registeredOwner.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="vestingDate">Vesting Date</label>
                            <p-calendar class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="vestingDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && l.vestingDate.errors" class="text-error"><br>
                                <div *ngIf="l.vestingDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="conditionsOfTitle">Conditions Of Title</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="conditionsOfTitle"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.conditionsOfTitle.errors" class="text-error"><br>
                                <div *ngIf="l.conditionsOfTitle.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="ownershipCategory">Ownership Category</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" 
                                inputId="ownershipCategory" [options]="ownershipCategories" [style]="{'width':'570px'}"
                                formControlName="ownershipCategory" optionLabel="name" placeholder="Please select">
                            </p-dropdown>
                            <div *ngIf="submitted && f.ownershipCategory.errors" class="text-error"><br>
                                <div *ngIf="l.ownershipCategory.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="stateOwnedPercentage">State Owned Percentage</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="stateOwnedPercentage"
                                autocomplete="off" type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.stateOwnedPercentage.errors" class="text-error"><br>
                                <div *ngIf="l.stateOwnedPercentage.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="landUse">Land Use %</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="landUse" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.landUse.errors" class="text-error"><br>
                                <div *ngIf="l.landUse.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="zoning">Zoning</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="zoning" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.zoning.errors" class="text-error"><br>
                                <div *ngIf="l.zoning.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="incomeLeaseStatus">Income Lease Status</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                inputId="incomeLeaseStatus" [options]="incomeLeaseStatuses"
                                formControlName="incomeLeaseStatus" (onChange)="setProvince($event)" optionLabel="name">
                            </p-dropdown>
                            <div *ngIf="submitted && f.incomeLeaseStatus.errors" class="text-error"><br>
                                <div *ngIf="l.incomeLeaseStatus.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                </p-fieldset>

                <p-fieldset legend="Lease Status" [toggleable]="true" collapsed="true" styleClass="mt-2">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="natureOfLease">Nature of Lease</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="natureOfLease"
                                [options]="natureOfLeases" formControlName="natureOfLease" [style]="{'width':'570px'}"
                                (onChange)="setDeedsOffice($event)" optionLabel="name" placeholder="Please select">
                            </p-dropdown>
                            <div *ngIf="submitted && f.natureOfLease.errors" class="text-error">
                                <br>
                                <div *ngIf="l.natureOfLease.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="IDNumberCompanyRegistrationNumber">ID Number/Company Registration
                                Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="IDNumberCompanyRegistrationNumber"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.IDNumberCompanyRegistrationNumber.errors" class="text-error">
                                <br>
                                <div *ngIf="l.IDNumberCompanyRegistrationNumber.errors.required">This field is
                                    required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="POBox">P.O.Box</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="POBox" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.POBox.errors" class="text-error"><br>
                                <div *ngIf="l.POBox.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="leaseStatusTown">Town</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="leaseStatusTown" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.town.errors" class="text-error"><br>
                                <div *ngIf="l.town.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="postalCode">Postal Code</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="postalCode" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.postalCode.errors" class="text-error"><br>
                                <div *ngIf="l.postalCode.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="contactPerson">Contact Person</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="contactPerson" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.contactPerson.errors" class="text-error">
                                <br>
                                <div *ngIf="l.contactPerson.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="capacityofContactPerson">Capacity of Contact Person</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="capacityofContactPerson"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.capacityofContactPerson.errors" class="text-error"><br>
                                <div *ngIf="l.capacityofContactPerson.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="contactNumber">Contact Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="contactNumber" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.contactNumber.errors" class="text-error">
                                <br>
                                <div *ngIf="l.contactNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="escalation">Escalation %</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="escalation" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.escalation.errors" class="text-error"><br>
                                <div *ngIf="l.escalation.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="occupationDate">Occupation Date</label>
                            <p-calendar [disabled]="isViewOnly" formControlName="occupationDate" dateFormat="dd/mm/yy"
                                showOtherMonths="true" showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && f.occupationDate.errors" class="text-error">
                                <br>
                                <div *ngIf="l.occupationDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="startingDate">Starting Date</label>
                            <p-calendar class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="startingDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && f.startingDate.errors" class="text-error"><br>
                                <div *ngIf="l.startingDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="terminationDate">Termination Date</label>
                            <p-calendar class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="terminationDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && f.terminationDate.errors" class="text-error">
                                <br>
                                <div *ngIf="l.terminationDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="rentalAmount">Rental Amount</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="rentalAmount" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.rentalAmount.errors" class="text-error"><br>
                                <div *ngIf="l.rentalAmount.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="otherCharges">Other charges</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="otherCharges" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.otherCharges.errors" class="text-error"><br>
                                <div *ngIf="l.otherCharges.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="leaseNumber">Lease Number</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="leaseNumber" autocomplete="off"
                                type="number" pInputText class="ui-inputtext ui-widget">
                            <div *ngIf="submitted && f.leaseNumber.errors" class="text-error"><br>
                                <div *ngIf="l.leaseNumber.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-3">
                        <span class="p-input-icon-left p-1">
                            <label for="vat">Vat Number</label>
                            <p-dropdown class="ui-inputtext ui-widget" [disabled]="isViewOnly" inputId="vat" [style]="{'width':'570px'}"
                                [options]="vats" formControlName="vat" (onChange)="setVat($event)"
                                placeholder="Please select" optionLabel="name"></p-dropdown>
                            <div *ngIf="submitted && f.vat.errors" class="text-error"><br>
                                <div *ngIf="l.vat.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                </p-fieldset>
            </div>
            <p-footer>
                <button style="float: left; margin-top: 15px;" type="button" pButton icon="pi pi-times"
                    (click)="showDialog=false" label="Cancel" class="ui-button-secondary"></button>
                <button style="float: right; margin-top: 15px" type="button" (click)="activeIndex = 1" pButton
                    icon="pi pi-angle-right" label="Next"></button>
                <button *ngIf="mode != 'View' && (currentUser.roleId == 3 || currentUser.roleId == 2)"
                    style="float: right; margin-top: 15px;margin-right: 10px" type="submit" pButton icon="pi pi-check"
                    label="Save"></button>
            </p-footer>
        </form>
    </p-tabPanel>
    <p-tabPanel header="Finance">
        <form [formGroup]="financialForm" *ngIf="!loading" (ngSubmit)="onFinancialFormSubmit()">
            <div class="ui-g ui-fluid" style="overflow-y: auto; overflow-x: hidden; height: 500px;width: 100%">
                <div class="ui-g-12 ui-md-12">
                    <p-fileUpload #fFiles [showUploadButton]="false" [showCancelButton]="false"
                        (onRemove)="onFinanceRemoveFile($event)" (onSelect)="onFinanceSelectFile($event.files)"
                        name="myfile[]" url="./upload.php" multiple="multiple"></p-fileUpload>
                    <div>
                        <ul *ngFor="let file of financeFiles; let i = index" style="list-style-type:none;">
                            <li>
                                <p><a target="_blank" href="{{ file.url }}">{{ file.name }}</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <p-fieldset legend="General" [toggleable]="true">
                    <div class="formgrid grid">
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="landUseClass">Land Use Class</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="landUseClass" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.landUseClass.errors" class="text-error"><br>
                                <div *ngIf="f.landUseClass.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="class">Nature of Asset</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="natureofAsset" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.natureofAsset.errors" class="text-error"><br>
                                <div *ngIf="f.natureofAsset.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="afs">AFS</label>
                            <p-dropdown class="ui-inputtext ui-widget w-full" inputId="afs" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                [options]="aFSs" placeholder="Please select" formControlName="afs" optionLabel="name">
                            </p-dropdown>
                            <div *ngIf="submitted && f.afs.errors" class="text-error"><br>
                                <div *ngIf="l.afs.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                </p-fieldset>
                <p-fieldset legend="Valuations" [toggleable]="true">
                    <div class="formgrid grid">
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="municipalValuation">Municipal Valuations</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="municipalValuation"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.municipalValuation.errors" class="text-error"><br>
                                <div *ngIf="f.municipalValuation.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="municipalValuationDate">Date of Municipal Valuation</label>
                            <p-calendar class="ui-inputtext ui-widget w-full" [disabled]="isViewOnly"
                                formControlName="municipalValuationDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && f.municipalValuationDate.errors" class="text-error"><br>
                                <div *ngIf="f.municipalValuationDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="class">Non Municipal Valuation</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="nonMunicipalValuation"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.nonMunicipalValuation.errors" class="text-error"><br>
                                <div *ngIf="f.nonMunicipalValuation.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="value">Fair Value</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="value" autocomplete="off"
                                type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.value.errors" class="text-error"><br>
                                <div *ngIf="f.value.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="nonMunicipalValuationDate">Date of Non Municipal Valuation</label>
                            <p-calendar class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="nonMunicipalValuationDate" dateFormat="dd/mm/yy" showOtherMonths="true"
                                showButtonBar="true"></p-calendar>
                            <div *ngIf="submitted && f.nonMunicipalValuationDate.errors" class="text-error"><br>
                                <div *ngIf="f.nonMunicipalValuationDate.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>

                    </div>

                    <div class="formgrid grid">
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="accountNoForService">Account no for Services</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="accountNoForService"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget w-full"
                                [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                            <div *ngIf="submitted && f.accountNoForService.errors" class="text-error"><br>
                                <div *ngIf="f.accountNoForService.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="personInstitutionResposible">Institution responsible for account</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="personInstitutionResposible"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget w-full"
                                [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                            <div *ngIf="submitted && f.personInstitutionResposible.errors" class="text-error"><br>
                                <div *ngIf="f.personInstitutionResposible.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="propetyRatesAccount">Property Rates Account No</label>
                            <input [attr.disabled]="mode == 'View'" formControlName="propetyRatesAccount"
                                autocomplete="off" type="text" pInputText class="ui-inputtext ui-widget w-full">
                            <div *ngIf="submitted && f.propetyRatesAccount.errors" class="text-error"><br>
                                <div *ngIf="f.propetyRatesAccount.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>

                </p-fieldset>
                <p-fieldset legend="Secondary Information Note" [toggleable]="true">
                    <div class="formgrid grid">
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="openingBalance">Opening Balance</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="openingBalance" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.openingBalance.errors" class="text-error"><br>
                                <div *ngIf="f.openingBalance.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="additionCash">Additions Cash</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="additionCash" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.additionCash.errors" class="text-error"><br>
                                <div *ngIf="f.additionCash.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="additionNonCash">Additions Non Cash</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="additionNonCash" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.additionNonCash.errors" class="text-error"><br>
                                <div *ngIf="f.additionNonCash.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                    </div>
                    <div class="formgrid grid">
                        <div class="field grid col-4">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="class">Additions</label>
                                <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                    formControlName="addition" mode="currency" currency="ZAR" locale="en-ZA">
                                </p-inputNumber>
                                <div *ngIf="submitted && f.addition.errors" class="text-error"><br>
                                    <div *ngIf="f.addition.errors.required">This field is required.</div>
                                </div>
                            </span>
                            </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="disposal">Disposal</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="disposal" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.disposal.errors" class="text-error"><br>
                                <div *ngIf="f.disposal.errors.required">This field is required.</div>
                            </div>
                        </span>
                        </div>
                        <div class="field grid col-4">
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="closingBalance">Closing Balance</label>
                            <p-inputNumber class="ui-inputtext ui-widget" [disabled]="isViewOnly"
                                formControlName="closingBalance" mode="currency" currency="ZAR" locale="en-ZA">
                            </p-inputNumber>
                            <div *ngIf="submitted && f.closingBalance.errors" class="text-error"><br>
                                <div *ngIf="f.closingBalance.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>
                    </div>

                </p-fieldset>
            </div>
            <p-footer>
                <button style="float: left; margin-top: 15px;" type="button" pButton icon="pi pi-angle-left"
                    (click)="activeIndex = 0" label="Back" class="ui-button-secondary"></button>
                <button style="float: right; margin-top: 15px" type="button" pButton icon="pi pi-angle-right"
                    label="Next" (click)="activeIndex = 2"></button>
                <button *ngIf="mode != 'View' && (currentUser.roleId == 3 || currentUser.roleId == 2)"
                    style="float: right; margin-top: 15px;margin-right: 10px" type="submit" pButton icon="pi pi-check"
                    label="Save"></button>
            </p-footer>
        </form>
    </p-tabPanel>
    <p-tabPanel header="Improvement" *ngIf="facility.type != 'Land'">
        <form [formGroup]="improvementForm" *ngIf="!loading" (ngSubmit)="onImprovementFormSubmit()">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12 ui-md-12">
                    <p-fileUpload #iFiles [showUploadButton]="false" [showCancelButton]="false"
                        (onRemove)="onImprovementRemoveFile($event)" (onSelect)="onImprovementSelectFile($event.files)"
                        name="myfile[]" multiple="multiple" (uploadHandler)="upload($event)"></p-fileUpload>
                    <div>
                        <ul *ngFor="let file of improvementFiles; let i = index" style="list-style-type:none;">
                            <li>
                                <p><a target="_blank" href="{{ file.url }}">{{ file.name }}</a></p>
                            </li>
                        </ul>
                    </div>
                </div>
                <p-fieldset legend="General" [toggleable]="true">
                    <div class="formgrid grid">
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="deedsOffice">Building Name</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="buildingName" autocomplete="off"
                                    type="text" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && I.name.errors }">
                                <div *ngIf="submitted && I.buildingName.errors" class="text-error"><br>
                                    <div *ngIf="I.buildingName.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>                       
                       
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="type">Size (m2)</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="size" autocomplete="off"
                                    type="number" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.size.errors" class="text-error"><br>
                                    <div *ngIf="I.size.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                       
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="extentofBuilding">Extent of Building (m2)</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="extentofBuilding"
                                    autocomplete="off" type="number" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.extentofBuilding.errors" class="text-error"><br>
                                    <div *ngIf="I.extentofBuilding.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>       
                        
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="siteCoverag">Site Coverage %</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="siteCoverag" autocomplete="off"
                                    type="number" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.siteCoverag.errors" class="text-error"><br>
                                    <div *ngIf="I.siteCoverag.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                    </div>

                    <div class="formgrid grid">
                    <div class="field grid col-3">       
                        <span class="p-input-icon-left p-1 w-full">
                            <label for="class">Potential Use</label>
                            <p-dropdown class="ui-inputtext ui-widget w-full" [disabled]="isViewOnly" inputId="potentialUse" [style]="{'width':'570px'}"
                                [options]="potentialUseList" placeholder="Please select" formControlName="potentialUse"
                                (onChange)="setClass($event)" optionLabel="name">
                            </p-dropdown>
                            <div *ngIf="submitted && I.potentialUse.errors" class="text-error"><br>
                                <div *ngIf="I.potentialUse.errors.required">This field is required.</div>
                            </div>
                        </span>
                    </div>  
                 
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="class">Type</label>
                                <p-dropdown class="ui-inputtext ui-widget w-full" [disabled]="isViewOnly" inputId="type" [style]="{'width':'570px'}"
                                    [options]="typeOfImprovements" formControlName="type" (onChange)="setClass($event)"
                                    optionLabel="name" placeholder="Please select">
                                </p-dropdown>
                                <div *ngIf="submitted && I.type.errors" class="text-error"><br>
                                    <div *ngIf="I.type.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>                      
                        
                       
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="class">Condition Rating</label>
                                <p-dropdown class="ui-inputtext ui-widget w-full" [disabled]="isViewOnly" inputId="conditionRating" [style]="{'width':'570px'}"
                                    [options]="conditionRatings" formControlName="conditionRating"
                                    (onChange)="setConditionRating($event)" placeholder="Please select" optionLabel="name">
                                </p-dropdown>
                                <div *ngIf="submitted && I.conditionRating.errors" class="text-error"><br>
                                    <div *ngIf="I.conditionRating.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>

                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="class">Functional Performance Rating</label>
                                <p-dropdown class="ui-inputtext ui-widget w-full" [disabled]="isViewOnly" [style]="{'width':'570px'}"
                                    inputId="functionalPerformanceRating" [options]="functionalPerformanceRatings"
                                    formControlName="functionalPerformanceRating" (onChange)="setClass($event)"
                                    placeholder="Please select" optionLabel="name">
                                </p-dropdown>
                                <div *ngIf="submitted && I.functionalPerformanceRating.errors" class="text-error"><br>
                                    <div *ngIf="I.functionalPerformanceRating.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                       
                    </div>

                    <div class="formgrid grid">

                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="levelofUtilization">Level of Utilization %</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="levelofUtilization"
                                    autocomplete="off" type="number" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.levelofUtilization.errors" class="text-error"><br>
                                    <div *ngIf="I.levelofUtilization.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>

                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="type">Usable area(m2)</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="usableArea" autocomplete="off"
                                    type="number" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.usableArea.errors" class="text-error"><br>
                                    <div *ngIf="I.usableArea.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                        
                        <div class="field grid col-3">
                            <span class="p-input-icon-left p-1 w-full">
                                <label for="type">Comments</label>
                                <input [attr.disabled]="mode == 'View'" formControlName="comment" autocomplete="off"
                                    type="text" pInputText class="ui-inputtext ui-widget w-full"
                                    [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                <div *ngIf="submitted && I.comment.errors" class="text-error"><br>
                                    <div *ngIf="I.comment.errors.required">This field is required.</div>
                                </div>
                            </span>
                        </div>
                       
                        <div class="field grid p-1 pl-2 col-3" style="float: right;">
                            <button *ngIf="mode != 'View'" (click)="AddImprovement()" pButton pRipple type="button"
                                icon="pi pi-plus" iconPos="left" class="p-button-rounded btn-add" label="Add"></button>
                        </div>
                    </div>

                    <div class="formgrid grid">
                        <p-table #dt [columns]="improvementCols" [paginator]="true" [rows]="5" selectionMode="single"
                            rowExpandMode="single" [value]="improvements" dataKey="id" editMode="row"
                            styleClass="p-datatable-striped">
                            <ng-template pTemplate="caption">
                                <div style="text-align: right">
                                    <i class="pi pi-search" style="margin:4px 4px 0 0"></i>
                                    <input [attr.disabled]="mode == 'View'" type="text" pInputText size="50"
                                        placeholder="Global Filter" class="ui-inputtext ui-widget"
                                        (input)="dt.filterGlobal($event.target.value, 'contains')" style="width:auto">
                                </div>
                            </ng-template>
                            <ng-template pTemplate="header">
                                <tr>
                                    <th *ngFor="let col of improvementCols">
                                        {{col.header}}
                                        <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                                            ariaLabelDesc="Activate to sort in descending order"
                                            ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                                    </th>
                                    <th style="width:10em">Actions</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                                <tr [pEditableRow]="rowData">
                                    <td *ngFor="let col of improvementCols">
                                        {{rowData[col.field]}}
                                    </td>
                                    <td style="text-align: center;">
                                        <p-splitButton label="More" *ngIf="mode != 'View'" [model]="buttonItems"
                                            (onDropdownClick)="selectImprovement(rowData)"
                                            styleClass="p-button-secondary">
                                        </p-splitButton>
                                    </td>
                                </tr>

                            </ng-template>
                        </p-table>
                    </div>
                </p-fieldset>
            </div>

            <p-footer>
                <div style="text-align: center;" *ngIf="errorMsg != ''">

                </div>
                <div>
                    <button style="float: left; margin-top: 15px;" type="button" pButton icon="pi pi-angle-left"
                        (click)="activeIndex = 1" label="Back" class="ui-button-secondary"></button>
                    <button *ngIf="mode != 'View' && (currentUser.roleId == 3 || currentUser.roleId == 2)"
                        style="float: right; margin-top: 15px" type="button" (click)="onSubmit()" pButton
                        icon="pi pi-angle-right" label="Submit" (click)="activeIndex = 2"></button>
                    <button *ngIf="mode != 'View' && currentUser.roleId == 4" style="float: right; margin-top: 15px"
                        type="button" (click)="onSubmit()" pButton icon="pi pi-angle-right" label="Sign Off"
                        (click)="activeIndex = 2"></button>
                    <button *ngIf="mode != 'View' && currentUser.roleId == 5" style="float: right; margin-top: 15px"
                        type="button" (click)="onSubmit()" pButton icon="pi pi-angle-right" label="Approve"
                        (click)="activeIndex = 2"></button>
                </div>
            </p-footer>
        </form>
    </p-tabPanel>
</p-tabView>