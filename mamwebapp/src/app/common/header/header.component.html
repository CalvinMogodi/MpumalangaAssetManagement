<div class="topbar clearfix">
    <div class="topbar-left">
        <img class="topbar-logo" src="../../../assets/images/logo.png">
    </div>
    <div class="topbar-right">

        <a (click)="showSideMenu = !showSideMenu" id="menu-button" class="">
            <i *ngIf="showSideMenu == true" class="pi pi-angle-left"></i>
            <i *ngIf="showSideMenu == false" class="pi pi-angle-right"></i>
        </a><a href="#" id="topbar-menu-button"><i class="fa fa-bars"></i></a>
        <ul class="topbar-items fadeInDown">
            <li><a (click)="showSettings = !showSettings"><i class="pi pi-cog topbar-icon"></i> <span
                        class="topbar-item-name">Settings</span></a>
                <ul class="layout-menu fadeInDown" *ngIf="showSettings">
                    <li role="menuitem"><a (click)="showDialog = !showDialog; showSettings = false"><i
                                class="pi pi-key pr-2"></i><span>Change Password</span></a>
                    </li>
                    <li role="menuitem"><a (click)="logout()"><i class="pi pi-lock pr-2"></i><span>Logout</span></a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</div>
<div *ngIf="showSideMenu" class="transition-delay">
    <app-sidemenu></app-sidemenu>
</div>
<div *ngIf="showDialog" class="dialogBackgroud"></div>
<p-dialog header="Change Password" [(visible)]="showDialog" [style]="{width: '40vw'}" [baseZIndex]="10000">
    <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
        <div class="p-fluid p-grid p-formgrid">
            <span class="p-float-label p-input-icon-left mt-5">
                <i class="pi pi-key"></i>
                <p-password formControlName="oldpassword" class="ui-inputtext ui-widget" [toggleMask]="true"></p-password>
                <label for="float-input">Old Password</label>
                <small *ngIf="submitted && f.oldpassword.errors && f.oldpassword.errors.required" class="p-error">This
                    field is required.</small>
            </span>

            <span class="p-float-label p-input-icon-left mt-5">
                <i class="pi pi-key"></i>
                <p-password formControlName="newpassword" [(ngModel)]="newPassword" [toggleMask]="true" class="ui-inputtext ui-widget">
                    <ng-template pTemplate="header">
                        <h6>Pick a password</h6>
                    </ng-template>
                    <ng-template pTemplate="footer">
                        <p-divider></p-divider>
                        <p class="p-mt-2">Suggestions</p>
                        <ul class="p-pl-2 p-ml-2 p-mt-0" style="line-height: 1.5">
                            <li>At least one lowercase</li>
                            <li>At least one uppercase</li>
                            <li>At least one numeric</li>
                            <li>Minimum 8 characters</li>
                        </ul>
                    </ng-template>
                </p-password>  
                <label for="float-input">New Password</label>   
                <small *ngIf="submitted && f.newpassword.errors && f.newpassword.errors.required" class="p-error">This field is required.</small>
                <small *ngIf="submitted && f.newpassword.errors && f.newpassword.errors.pattern" class="p-error">The password does not meet the password policy requirements.</small>              
            </span>

            <span class="p-float-label p-input-icon-left mt-5">
                    <i class="pi pi-key"></i>
                    <p-password formControlName="confirmpassword" class="ui-inputtext ui-widget" [toggleMask]="true"></p-password>
                    <label for="float-input">Confirm Password</label>   
                    <small *ngIf="submitted && f.confirmpassword.errors && f.confirmpassword.errors.required" class="p-error">This field is required.</small>
                    <small *ngIf="newPassword.length > 2 && f.confirmpassword.value !== f.newpassword.value" class="p-error">Passwords do not match.</small>
            </span>
            <div *ngIf="error" class="alert alert-danger mt-3 mb-0 text-error text-center">{{error}}</div>
        </div>
        <p-dialog-footer>
            <button style="float: left;" type="button" pButton icon="pi pi-times" (click)="showDialog=false"
                label="Cancel" class="ui-button-secondary mt-2"></button>
            <button style="float: right;" class="mt-2" type="submit" pButton icon="pi pi-check" label="Submit"></button>
        </p-dialog-footer>
    </form>
</p-dialog>

<p-toast [style]="{marginTop: '80px'}" position="top-right"></p-toast>